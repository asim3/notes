..title..
Kubernetes

..link.. devops/kubernetes.txt
..

..text..
Manifest file
..code..
nano my-k8s/my-first-deployment.yml

apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-metadata-name
  labels:
    my-app: my-metadata-label
spec:
  selector:
    matchLabels:
      app: my-spec-temp-meta-label
  template:
    metadata:
      labels:
        app: my-spec-temp-meta-label
    spec:
      containers:
      - name: my-nginx-container
        image: nginx:1.7.9
        ports:
        - containerPort: 80
  replicas: 3


..text..
deploy
..code..
sudo kubectl create -f my-k8s/my-first-deployment.yml


..text..
delete
..code..
sudo kubectl delete -f my-k8s/my-first-deployment.yml
# OR
sudo kubectl delete deployment my-metadata-name
# OR
sudo kubectl delete deploy my-metadata-name



..text..
list
..code..
sudo kubectl get deploy -o wide
sudo kubectl get pods -o wide

# ReplicaSet
sudo kubectl get rs


..text..
full deployment details
..code..
sudo kubectl describe deploy my-metadata-name
sudo kubectl describe deployment/my-metadata-name

# see updating status
sudo kubectl rollout status deployment/my-metadata-name


..text..
update
..code..
sudo kubectl apply -f my-k8s/my-first-deployment.yml
# OR
sudo kubectl edit deploy my-metadata-name
# OR
sudo kubectl set image deploy my-metadata-name nginx-container=nginx:1.9.1


..text..
rollback
..code..
# if rollout isn't updating
# look for error in history
sudo kubectl rollout history deployment/my-metadata-name

# undo the last update
sudo kubectl rollout undo deployment/my-metadata-name
sudo kubectl rollout status deployment/my-metadata-name


..text..
scaling
..code..
sudo kubectl scale deploy my-metadata-name --replicas=5
