
..title..
Kubernetes

..link.. devops/kubernetes.txt
..
..link.. https://github.com/bitnami/kube-prod-runtime/blob/master/docs/quickstart-generic.md
Docs


..sub_title..
Bitnami Kubernetes Production Runtime


..text..
Install kubeprod
..code..
sudo apt  install jq

# set temporary environment variable
BKPR_VERSION=$(curl --silent "https://api.github.com/repos/bitnami/kube-prod-runtime/releases/latest" | jq -r '.tag_name')

curl -LO https://github.com/bitnami/kube-prod-runtime/releases/download/${BKPR_VERSION}/bkpr-${BKPR_VERSION}-linux-amd64.tar.gz

tar xf bkpr-${BKPR_VERSION}-linux-amd64.tar.gz

chmod +x bkpr-${BKPR_VERSION}/kubeprod
sudo mv bkpr-${BKPR_VERSION}/kubeprod /usr/local/bin/

sudo kubeprod version


..text..
Deploy BKPR
..code..
nano ~/.bashrc

export DNS_ZONE=my-domain.com
export ADMIN_EMAIL=admin@my-domain.com
export OAUTH_AUTHZ_DOMAIN="my-domain.com"
export KEYCLOAK_PASSWORD="secretpassword"
export KEYCLOAK_GROUP=""


sudo kubeprod install generic \
  --dns-zone "${DNS_ZONE}" \
  --email "${ADMIN_EMAIL}" \
  --authz-domain "${OAUTH_AUTHZ_DOMAIN}" \
  --keycloak-password "${KEYCLOAK_PASSWORD}" \
  --keycloak-group "${KEYCLOAK_GROUP}"


sudo kubectl get pods
sudo kubectl get pods -n kubeprod


..text..
Configure domain registration records
..code..
kubectl -n kubeprod get svc nginx-ingress-udp -o jsonpath='{.status.loadBalancer.ingress[0].ip}'

