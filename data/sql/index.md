[docs](https://www.postgresql.org/docs/14/index.html)
[tutorial](https://www.postgresqltutorial.com/postgresql-administration/)


## delete old
```bash
docker container stop my_postgresql_container
docker container prune -f
docker container ls -a
```


## install
```bash
docker run \
    --name my_postgresql_container \
    -e POSTGRESQL_PASSWORD=admin \
    -d bitnami/postgresql:latest

docker exec -it my_postgresql_container bash
```


## connect to database
```bash
export PGPASSWORD=admin


psql -U username

psql -U postgres -d my_database

psql -U username -d my_database -h hostname -p port

# OR

psql postgresql://username:password@hostname:port/my_database

psql postgresql://postgres:admin@localhost:5432/postgres
```


## add new user
Create a new role by executing the createuser command. With the options 
below, the new role will not be a superuser and will not have privileges 
for creating new databases or new roles (this is usually the default 
for the createuser command).
```bash
createuser -U postgres my_new_sql_user -S -D -R -P
# Enter password for new role: my-new-pass
# Enter it again: my-new-pass
# Password: admin
```


## list users `\dg`
```txt
                                      List of roles
    Role name    |                         Attributes                         | Member of 
-----------------+------------------------------------------------------------+-----------
 my_new_sql_user |                                                            | {}
 postgres        | Superuser, Create role, Create DB, Replication, Bypass RLS | {}
```


## add new db
```bash
createdb -U postgres my_new_sql_db -O my_new_sql_user
# Password: admin
```


## list db `\l`
```txt
                                       List of databases
     Name      |      Owner      | Encoding |   Collate   |    Ctype    |   Access privileges   
---------------+-----------------+----------+-------------+-------------+-----------------------
 my_database   | postgres        | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 my_new_sql_db | my_new_sql_user | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 postgres      | postgres        | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 template0     | postgres        | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |                 |          |             |             | postgres=CTc/postgres
 template1     | postgres        | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |                 |          |             |             | postgres=CTc/postgres
(5 rows)
```


## cli
```bash
psql -U postgres -c 'CREATE DATABASE my_database_4;'

psql -U postgres -d my_database_4 -c 'SELECT * FROM mytable'
```


## help
```text
-a, --echo-all          Print all nonempty input lines to standard output as they are read. 
                        (This does not apply to lines read interactively.) This is equivalent 
                        to setting the variable ECHO to all.

-A, --no-align          Switches to unaligned output mode. (The default output mode is 
                        otherwise aligned.)

-c command
--command=command       


-d dbname
--dbname=dbname         Specifies the name of the database to connect to. This is equivalent to 
                        specifying dbname as the first non-option argument on the command line.

-e, --echo-queries      Copy all SQL commands sent to the server to standard output as well. 
                        This is equivalent to setting the variable ECHO to queries.

-E, --echo-hidden       Echo the actual queries generated by \d and other backslash commands. 
                        You can use this to study psql's internal operations. This is equivalent 
                        to setting the variable ECHO_HIDDEN to on.

-f filename
--file=filename         Use the file filename as the source of commands instead of reading
                        commands interactively. After the file is processed, psql terminates. 
                        This is in many ways equivalent to the meta-command \i.
    
                        If filename is - (hyphen), then standard input is read until an EOF 
                        indication or \q meta-command. Note however that Readline is not used 
                        in this case (much as if -n had been specified).
    
                        Using this option is subtly different from writing psql < filename. In 
                        general, both will do what you expect, but using -f enables some nice 
                        features such as error messages with line numbers. There is also a slight 
                        chance that using this option will reduce the start-up overhead. On the other 
                        hand, the variant using the shell's input redirection is (in theory) 
                        guaranteed to yield exactly the same output you would have received had you 
                        entered everything by hand.

-F separator
--field-separator=separator
                        Use separator as the field separator for unaligned output. This is equivalent 
                        to \pset fieldsep or \f.

-h hostname
--host=hostname         Specifies the host name of the machine on which the server is running. 
                        If the value begins with a slash, it is used as the directory for the 
                        Unix-domain socket.

-H, --html              Turn on HTML tabular output. This is equivalent to \pset format html 
                        or the \H command.

-l, --list              List all available databases, then exit. Other non-connection options 
                        are ignored. This is similar to the meta-command \list.

-L filename
--log-file=filename     Write all query output into file filename, in addition to the normal 
                        output destination.

-n, --no-readline       Do not use Readline for line editing and do not use the command history. 
                        This can be useful to turn off tab expansion when cutting and pasting.

-o filename
--output=filename       Put all query output into file filename. This is equivalent to the command \o.

-p port, --port=port    Specifies the TCP port or the local Unix-domain socket file extension on which
                        the server is listening for connections. Defaults to the value of the PGPORT 
                        environment variable or, if not set, to the port specified at compile time, 
                        usually 5432.

-P assignment
--pset=assignment       Specifies printing options, in the style of \pset. Note that here you have to 
                        separate name and value with an equal sign instead of a space. For example, to 
                        set the output format to LaTeX, you could write -P format=latex.

-q, --quiet             Specifies that psql should do its work quietly. By default, it prints welcome 
                        messages and various informational output. If this option is used, none of this 
                        happens. This is useful with the -c option. This is equivalent to setting the 
                        variable QUIET to on.

-R separator
--record-separator=separator
                        Use separator as the record separator for unaligned output. This is equivalent 
                        to the \pset recordsep command.

-s, --single-step       Run in single-step mode. That means the user is prompted before each command 
                        is sent to the server, with the option to cancel execution as well. Use this 
                        to debug scripts.

-S, --single-line       Runs in single-line mode where a newline terminates an SQL command, as a 
                        semicolon does.

                        Note: This mode is provided for those who insist on it, but you are not necessarily 
                        encouraged to use it. In particular, if you mix SQL and meta-commands on a line 
                        the order of execution might not always be clear to the inexperienced user.

-t, --tuples-only       Turn off printing of column names and result row count footers, etc. This is 
                        equivalent to the \t command.

-T table_options
--table-attr=table_options
                        Specifies options to be placed within the HTML table tag. See \pset for details.

-U username
--username=username
                        Connect to the database as the user username instead of the default. 
                        (You must have permission to do so, of course.)

-v assignment
--set=assignment
--variable=assignment
                        Perform a variable assignment, like the \set meta-command. Note that you must 
                        separate name and value, if any, by an equal sign on the command line. To 
                        unset a variable, leave off the equal sign. To set a variable with an empty 
                        value, use the equal sign but leave off the value. These assignments are done 
                        during a very early stage of start-up, so variables reserved for internal 
                        purposes might get overwritten later.

-V, --version           Print the psql version and exit.

-w
--no-password
                        Never issue a password prompt. If the server requires password authentication 
                        and a password is not available by other means such as a .pgpass file, the 
                        connection attempt will fail. This option can be useful in batch jobs and 
                        scripts where no user is present to enter a password.
                        
                        Note that this option will remain set for the entire session, and so it 
                        affects uses of the meta-command \connect as well as the initial connection 
                        attempt.

-W, --password          Force psql to prompt for a password before connecting to a database.
                        
                        This option is never essential, since psql will automatically prompt for 
                        a password if the server demands password authentication. However, psql 
                        will waste a connection attempt finding out that the server wants a password. 
                        In some cases it is worth typing -W to avoid the extra connection attempt.

                        Note that this option will remain set for the entire session, and so it affects 
                        uses of the meta-command \connect as well as the initial connection attempt.

-x, --expanded          Turn on the expanded table formatting mode. This is equivalent to the \x command.

-X, --no-psqlrc         Do not read the start-up file (neither the system-wide psqlrc file nor the 
                        user's ~/.psqlrc file).

-z
--field-separator-zero
                        Set the field separator for unaligned output to a zero byte.

-0, --record-separator-zero
                        Set the record separator for unaligned output to a zero byte. This is useful 
                        for interfacing, for example, with xargs -0.

-1, --single-transaction
                        When psql executes a script with the -f option, adding this option wraps 
                        BEGIN/COMMIT around the script to execute it as a single transaction. This 
                        ensures that either all the commands complete successfully, or no changes 
                        are applied.

                        If the script itself uses BEGIN, COMMIT, or ROLLBACK, this option will not 
                        have the desired effects. Also, if the script contains any command that cannot 
                        be executed inside a transaction block, specifying this option will cause 
                        that command (and hence the whole transaction) to fail.

-?
--help                  Show help about psql command line arguments, and exit.
```


## psql functions
meta-command
```txt
General
  \copyright             show PostgreSQL usage and distribution terms
  \crosstabview [COLUMNS] execute query and display results in crosstab
  \errverbose            show most recent error message at maximum verbosity
  \g [FILE] or ;         execute query (and send results to file or |pipe)
  \gdesc                 describe result of query, without executing it
  \gexec                 execute query, then execute each value in its result
  \gset [PREFIX]         execute query and store results in psql variables
  \gx [FILE]             as \g, but forces expanded output mode
  \q                     quit psql
  \watch [SEC]           execute query every SEC seconds



Help
  \? [commands]          show help on backslash commands
  \? options             show help on psql command-line options
  \? variables           show help on special variables
  \h [NAME]              help on syntax of SQL commands, * for all commands



Query Buffer
  \e [FILE] [LINE]       edit the query buffer (or file) with external editor
  \ef [FUNCNAME [LINE]]  edit function definition with external editor
  \ev [VIEWNAME [LINE]]  edit view definition with external editor
  \p                     show the contents of the query buffer
  \r                     reset (clear) the query buffer
  \s [FILE]              display history or save it to file
  \w FILE                write query buffer to file



Input/Output
  \copy ...              perform SQL COPY with data stream to the client host
  \echo [STRING]         write string to standard output
  \i FILE                execute commands from file
  \ir FILE               as \i, but relative to location of current script
  \o [FILE]              send all query results to file or |pipe
  \qecho [STRING]        write string to query output stream (see \o)



Conditional
  \if EXPR               begin conditional block
  \elif EXPR             alternative within current conditional block
  \else                  final alternative within current conditional block
  \endif                 end conditional block



Informational
  (options: S = show system objects, + = additional detail)
  \d[S+]                 list tables, views, and sequences
  \d[S+]  NAME           describe table, view, sequence, or index
  \da[S]  [PATTERN]      list aggregates
  \dA[+]  [PATTERN]      list access methods
  \db[+]  [PATTERN]      list tablespaces
  \dc[S+] [PATTERN]      list conversions
  \dC[+]  [PATTERN]      list casts
  \dd[S]  [PATTERN]      show object descriptions not displayed elsewhere
  \dD[S+] [PATTERN]      list domains
  \ddp    [PATTERN]      list default privileges
  \dE[S+] [PATTERN]      list foreign tables
  \det[+] [PATTERN]      list foreign tables
  \des[+] [PATTERN]      list foreign servers
  \deu[+] [PATTERN]      list user mappings
  \dew[+] [PATTERN]      list foreign-data wrappers
  \df[anptw][S+] [PATRN] list [only agg/normal/procedures/trigger/window] functions
  \dF[+]  [PATTERN]      list text search configurations
  \dFd[+] [PATTERN]      list text search dictionaries
  \dFp[+] [PATTERN]      list text search parsers
  \dFt[+] [PATTERN]      list text search templates
  \dg[S+] [PATTERN]      list roles
  \di[S+] [PATTERN]      list indexes
  \dl                    list large objects, same as \lo_list
  \dL[S+] [PATTERN]      list procedural languages
  \dm[S+] [PATTERN]      list materialized views
  \dn[S+] [PATTERN]      list schemas
  \do[S+] [PATTERN]      list operators
  \dO[S+] [PATTERN]      list collations
  \dp     [PATTERN]      list table, view, and sequence access privileges
  \drds [PATRN1 [PATRN2]] list per-database role settings
  \dRp[+] [PATTERN]      list replication publications
  \dRs[+] [PATTERN]      list replication subscriptions
  \ds[S+] [PATTERN]      list sequences
  \dt[S+] [PATTERN]      list tables
  \dT[S+] [PATTERN]      list data types
  \du[S+] [PATTERN]      list roles
  \dv[S+] [PATTERN]      list views
  \dx[+]  [PATTERN]      list extensions
  \dy[+]  [PATTERN]      list event triggers
  \l[+]   [PATTERN]      list databases
  \sf[+]  FUNCNAME       show a function's definition
  \sv[+]  VIEWNAME       show a view's definition
  \z      [PATTERN]      same as \dp



Formatting
  \a                     toggle between unaligned and aligned output mode
  \C [STRING]            set table title, or unset if none
  \f [STRING]            show or set field separator for unaligned query output
  \H                     toggle HTML output mode (currently off)
  \pset [NAME [VALUE]]   set table output option
                         (NAME := {border|columns|expanded|fieldsep|fieldsep_zero|
                         footer|format|linestyle|null|numericlocale|pager|
                         pager_min_lines|recordsep|recordsep_zero|tableattr|title|
                         tuples_only|unicode_border_linestyle|
                         unicode_column_linestyle|unicode_header_linestyle})
  \t [on|off]            show only rows (currently off)
  \T [STRING]            set HTML <table> tag attributes, or unset if none
  \x [on|off|auto]       toggle expanded output (currently off)



Connection
  \c[onnect] {[DBNAME|- USER|- HOST|- PORT|-] | conninfo}
                         connect to new database (currently "postgres")
  \conninfo              display information about current connection
  \encoding [ENCODING]   show or set client encoding
  \password [USERNAME]   securely change the password for a user



Operating System
  \cd [DIR]              change the current working directory
  \setenv NAME [VALUE]   set or unset environment variable
  \timing [on|off]       toggle timing of commands (currently off)
  \! [COMMAND]           execute command in shell or start interactive shell



Variables
  \prompt [TEXT] NAME    prompt user to set internal variable
  \set [NAME [VALUE]]    set internal variable, or list all if no parameters
  \unset NAME            unset (delete) internal variable



Large Objects
  \lo_export LOBOID FILE
  \lo_import FILE [COMMENT]
  \lo_list
  \lo_unlink LOBOID      large object operations
```
